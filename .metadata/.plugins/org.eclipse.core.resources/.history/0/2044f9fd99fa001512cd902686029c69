package priv.hkon.theseq.cutscenes;

import priv.hkon.theseq.main.Core;
import priv.hkon.theseq.misc.VillageEvent;
import priv.hkon.theseq.sprites.Movable;
import priv.hkon.theseq.sprites.Player;
import priv.hkon.theseq.sprites.TalkativeSprite;
import priv.hkon.theseq.sprites.Woodcutter;

public class WoodCutterGuidesPlayerCutscene extends Cutscene {

	Player player;
	Woodcutter woodcutter;
	
	boolean fin = false;
	
	public WoodCutterGuidesPlayerCutscene(Woodcutter wc, Player p, Core c) {
		super(c);
		player = p;
		woodcutter = wc;
		player.isPartOfCutscene = true;
		wc.isPartOfCutscene = true;
		happenings.add(new Happening(woodcutter, 30){
			public void happen(){
				((TalkativeSprite)sprite).showDialog("Hey there!", 2*60);
			}
		});
		
		happenings.add(new Happening(player, 2*60){
			public void happen(){
				((Movable)sprite).startPathTo(player.getX(), player.getY() + 2);
			}
		});
		
		if(!woodcutter.classHasPresented()){
		
			happenings.add(new Happening(woodcutter, 3*60){
				public void happen(){
					((Woodcutter)woodcutter).addSentence(((Woodcutter)woodcutter).getPresentation());
					Woodcutter.presented = true;
				}
			});
		}
		
		happenings.add(new Happening(woodcutter, new VillageEvent(core.village, woodcutter, 0){
			public boolean isHappening(){
				return !((TalkativeSprite)subject).showDialog;
			}
		}){
			public void happen(){
				((TalkativeSprite)sprite).addSentence(new String[]{
					"I heard you would stay here",
					"I thought maybe you would be",
					"interested in something to do?",
					"I would really like to get to know..",
					"If you are a good punch or",
					"Just as useless as all the nobodies",
					"Sounds like a plan?",
					"Good, follow me"
				});
			}
		});
		
		fin = true;
		
	}
	

	@Override
	public boolean isFinished() {
		return fin;
	}
	
	public void tick(){
		super.tick();
	}
	
	public void close(){
		super.close();
		woodcutter.setToSpeakMode(new String[] {
				"As I told you, I am the woodcutter.",
				"I "
		}, new Integer[0], param);
	}

}
