package priv.hkon.theseq.sprites;

import priv.hkon.theseq.world.Tile;
import priv.hkon.theseq.world.Village;

public class Player extends Citizen {
	
	public Player(int x, int y, Village v, int i){
		super(x, y, v, i);
		moveSpeed = 0.5f;
	}
	
	@Override
	public void makeData() {//TODO: Make some actual design
		byte[] b = new byte[3];
		RAND.nextBytes(b);
		for(int i = 0; i < 3; i++){
			b[i] = (byte) (Math.abs(b[i]));
		}
		//coatColor = Sprite.getColor(b[0], b[1], b[2]);
		for(int i = 0; i < H; i++){
			for(int j = 0; j < W; j++){
				int d = (j-W/2)*(j-W/2) + (i - Villager.HEAD_OFFSET_Y)*(i - Villager.HEAD_OFFSET_Y);
				int c = 255;
				if(Math.abs(j - W/2) < ((float)i - Villager.HEAD_OFFSET_Y)/3){
					int p = (int) (30*Math.exp(-0.5*(int)Math.abs((j - W/2 - (float)(i-Villager.HEAD_OFFSET_Y)/5))));
					data[i][j] = Sprite.getColor( b[0] + p, b[1] + p, b[2] + p);
				}
				if(d < Villager.HEAD_SQ_RADIUS){
					c -= Math.sqrt(d)*15;
					data[i][j] = Sprite.getColor(c, c, c);
				}
			}
		}
	}
	
	public void makeAnimationFrames(){
		numFrames = 8;
		numAnimations = 1;
		animationFrames = new int[numAnimations][numFrames][H][W];
		
		byte[] b = new byte[3];
		RAND.nextBytes(b);
		for(int i = 0; i < 3; i++){
			b[i] = (byte) (Math.abs(b[i]));
		}
		//coatColor = Sprite.getColor(b[0], b[1], b[2]);
		for(int k = 0; k < numFrames; k++){
			for(int i = 0; i < H; i++){
				for(int j = 0; j < W; j++){
					int d = (j-W/2)*(j-W/2) + (i - Villager.HEAD_OFFSET_Y)*(i - Villager.HEAD_OFFSET_Y);
					int c = 255;
					if(Math.abs(j - W/2) < ((float)i - Villager.HEAD_OFFSET_Y)/3){
						int p = (int) (30*Math.exp(-0.5*(int)Math.abs((j - W/2 - (float)(i-Villager.HEAD_OFFSET_Y)/5))));
						data[i][j] = Sprite.getColor( b[0] + p, b[1] + p, b[2] + p);
					}
					if(d < Villager.HEAD_SQ_RADIUS){
						c -= Math.sqrt(d)*15;
						data[i][j] = Sprite.getColor(c, c, c);
					}
				}
			}
		}
	}
	
	public boolean tick(){
		boolean b = super.tick();
		
		data = animationFrames[0][Math.min((int)(getMovedFraction()*numFrames), numFrames - 1)];
		return b;
	}

}
